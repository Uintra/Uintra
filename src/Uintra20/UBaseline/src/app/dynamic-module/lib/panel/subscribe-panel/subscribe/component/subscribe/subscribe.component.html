<ng-container *ngIf="data">
    <h3 class="subscribe__title">
        {{data.title}}
    </h3>
    <p class="subscribe__description">
        {{data.description}}
    </p>

    <form #subscribeForm="ngForm" [ngClass]="{busy: isBusy}" class="subscribe__form">
        <div class="list">
            <div class="toggle-all-section">
                <label
                    [partlyChecked]="partlySelected"
                    (click)="toggleSelectAll()"
                    ubl-checkbox
                    [name]="'selectAll'"
                    [(ngModel)]="selectAll"></label>
                <button ubl-button class="toggleAll" (click)="button.toggled = !button.toggled" #button>
                    {{ 'mailchimpPanel.AllTopics' | translate }}({{ model?.length }})
                    <i class="icon icon-chevron-up" *ngIf="!!button.toggled"></i>
                    <i class="icon icon-chevron-down" *ngIf="!button.toggled"></i>
                </button>
            </div>

            <ng-container *ngIf="!!button.toggled">
                <label *ngFor="let listItem of model"
                    ubl-checkbox
                    [name]="listItem.id"
                    [(ngModel)]="listItem.checked">{{ listItem.name }}</label>
            </ng-container>
        </div>

        <div class="input-group">
            <input tabindex="0"
                class="subscribe__input--email"
                id="email"
                name="email"
                [pattern]="emailPattern"
                [(ngModel)]="email"
                (click)="isSuccess = undefined"
                #emailInput
                [placeholder]="'mailchimpPanel.WatermarkText' | translate" required type="email">

            <button ubl-button
                class="submit"
                (click)="onSubscribe(email)"
                [disabled]="!agreed || !subscribeForm.form.valid">
                {{ 'mailchimpPanel.ButtonText' | translate }}
                <i class="icon icon-arrow-right after" *ngIf="isSuccess === undefined"></i>
                <i class="icon after" *ngIf="isSuccess !== undefined"  [ngClass]="isSuccess ? 'icon-check' : 'icon-cross'"></i>
            </button>
        </div>
    </form>

    <label class="subscribe__agreements agreements" ubl-checkbox [(ngModel)]="agreed">
        {{ 'mailchimpPanel.AgreementText' | translate }}
    </label>

    <div class="subscribe__policy" (click)="showPrivacy.emit()">{{ 'mailchimpPanel.PrivacyPolicyLabel' | translate}}</div>
</ng-container>
